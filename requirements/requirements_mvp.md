# TODO・予実管理Webアプリ 要件定義 (更新版 v2)

## 1. アプリの目的

* 日々のタスク管理と、各タスクにかかる時間の予実管理を行い、作業時間の見積もり精度向上と生産性向上を支援する。
* タスクに説明、期限、優先度などの詳細情報を付与し、管理しやすくする。
* タスク完了後に振り返り（反省メモ）を行うことで、作業のボトルネックや改善点を発見しやすくする。

## 2. 機能要件

### 2.1. タスク管理機能

* **タスク登録:**
    * **タスク名** (必須) を入力できる。
    * **タスク説明** (任意) を複数行で入力できる。
    * タスクにかかる**予定時間** (必須、分単位の正の整数) を入力できる。
    * **期限** (任意) を日付で設定できる (`YYYY-MM-DD`形式)。
    * **優先度** (必須) を「高」「中」「低」から選択できる (デフォルトは「中」)。
    * 登録されたタスクは「実行中タスク」一覧に**ステータス「未着手」** (`todo`) として追加される。
* **タスク一覧表示 (タブ形式):**
    * 画面上部のタブで「実行中タスク」と「完了タスク」の表示を切り替えられる。
    * **実行中タスクタブ:**
        * ステータスが「完了」(`done`) 以外のタスクを一覧表示する。
        * 各タスクの表示項目:
            * タスク名
            * 優先度 (色付きの枠線ラベルで表示: 高=赤系, 中=オレンジ系, 低=グレー系)
            * ステータス (色付きの枠線ラベルで表示: 未着手=グレー系, 進行中=青系)
            * 期限 (YYYY-MM-DD形式 または "未設定")
            * タスク説明 (入力されていれば表示、改行反映)
            * 予定時間 (分)
            * 実績時間 (HH:MM:SS形式)
        * 各タスクに対する操作ボタン (**アイコン形式**、マウスオーバーでツールチップ表示):
            * 開始/停止 (▶ / ■)
            * 完了 (✓)
            * 削除 (ゴミ箱)
            * 編集 (鉛筆)
    * **完了タスクタブ:**
        * ステータスが「完了」(`done`) のタスクを一覧表示する。
        * 各タスクの表示項目:
            * タスク名
            * タスク説明 (入力されていれば表示、改行反映)
            * 反省メモ (入力されていれば表示、改行反映)
            * 予定時間 (HH:MM:SS形式)
            * 実績時間 (HH:MM:SS形式)
        * 各タスクに対する操作ボタン (**アイコン形式**、マウスオーバーでツールチップ表示):
            * 編集 (鉛筆)
* **タスク削除:**
    * 「実行中タスク」一覧の削除アイコンボタンを押すと、確認ダイアログが表示され、承認するとタスクが完全に削除される。
* **タスク完了:**
    * 「実行中タスク」一覧の完了アイコンボタンを押すと、後述の「反省メモ入力モーダル」が表示される。
    * 反省メモを保存すると、タスクの**ステータスが「完了」(`done`)** に変更され、「完了タスク」タブに移動（表示されるようになる）。

### 2.2. 時間計測機能

* **ストップウォッチ:**
    * 「実行中タスク」一覧の各タスクに、個別のストップウォッチ（開始/停止アイコンボタン）を表示する。
    * 開始アイコンボタンを押すと、時間計測を開始し、**ステータスが「進行中」(`doing`)** になる。ボタンは停止アイコンに変わる。
    * 停止アイコンボタンを押すと、時間計測を一時停止し、**ステータスが「未着手」(`todo`)** に戻る。ボタンは開始アイコンに変わる。
    * 計測時間はバックグラウンドで累積され（分単位）、タスク一覧の**実績時間**として HH:MM:SS 形式でリアルタイムに更新表示される。
* **実績時間の記録:**
    * ストップウォッチで計測された合計時間が、そのタスクの**実績時間**として内部的に保持される。

### 2.3. 反省メモ機能

* **メモ入力モーダル表示:**
    * 「実行中タスク」の完了アイコンボタンを押した際に、専用の**メモ入力モーダルウィンドウ**を表示する。
* **情報表示とメモ入力:**
    * モーダル内に、完了するタスクの**タスク名**、**予定時間**(HH:MM:SS)、**実績時間**(HH:MM:SS) を表示する。
    * **反省メモ**を入力するためのテキストエリアを表示する（既存のメモがあれば表示）。
* **保存と完了:**
    * 「保存して完了」ボタンを押すと、入力された反省メモがタスク情報として保存され、タスクのステータスが「完了」(`done`) になり、モーダルが閉じる。

### 2.4. 実行中タスク編集機能

* **編集モード:**
    * 「実行中タスク」一覧の各タスクに編集アイコンボタンを表示する。
    * 編集アイコンボタンを押すと、そのタスクの表示が編集フォームに切り替わる。
* **編集可能項目:**
    * タスク名
    * タスク説明
    * 予定時間 (分)
    * 期限
    * 優先度
    * (注意: 実績時間、ステータスは編集対象外)
* **保存とキャンセル:**
    * 編集フォーム内の「保存」ボタンを押すと、変更内容が保存され、表示モードに戻る。
    * 編集フォーム内の「キャンセル」ボタンを押すと、変更内容を破棄して表示モードに戻る。

### 2.5. 完了タスク編集機能

* **編集モード:**
    * 「完了タスク」一覧の各タスクに編集アイコンボタンを表示する。
    * 編集アイコンボタンを押すと、そのタスクの表示が編集フォームに切り替わる。
* **編集可能項目:**
    * タスク名
    * タスク説明
    * 予定時間 (分)
    * 実績時間 (分)
    * 反省メモ
    * (注意: 完了タスクの期限、優先度、ステータスは編集対象外)
* **保存とキャンセル:**
    * 編集フォーム内の「保存」ボタンを押すと、変更内容が保存され、表示モードに戻る。
    * 編集フォーム内の「キャンセル」ボタンを押すと、変更内容を破棄して表示モードに戻る。

## 3. 非機能要件

* **データ永続性:** ブラウザの**ローカルストレージ**を使用し、ブラウザを閉じてもタスク情報が消えないようにする。
* **ユーザー認証:** **不要**。個人が単一のブラウザで利用することを想定。
* **ユーザーインターフェース:** **GitHubライクなデザイン**を採用し、視認性と操作性を考慮する。CSS変数を活用する。ラベルは枠線スタイル、アクションボタンはアイコン形式を基本とする。
* **動作環境:** 主要なモダンPCブラウザ（Chrome, Firefox, Edge, Safariの最新版）で動作すること。スマートフォン対応は必須ではないが、基本的なレスポンシブ対応は考慮されている。
* **コード構成:** HTMLファイル内にCSSとJavaScriptをすべて記述する方式を維持する。

## 4. 画面構成

* **1画面 (タブ切り替え) + 1モーダルウィンドウ** で構成する。

* **画面1: メイン画面**
    * **役割:** タスクの登録、一覧表示（実行中/完了）、時間計測、完了操作、編集操作を行う。
    * **主要要素:**
        * **ヘッダー:** アプリケーションタイトル表示。
        * **タブナビゲーション:** 「実行中タスク」「完了タスク」の切り替えボタン。
        * **タブコンテンツエリア:**
            * **実行中タスクペイン (デフォルト表示):**
                * 新規タスク入力エリア（タスク名、説明、予定時間、期限、優先度）と登録ボタン。
                * 実行中タスク一覧表示エリア (`#taskList`)。各項目にアイコン形式のアクションボタン（開始/停止, 完了, 削除, 編集）が付随。
            * **完了タスクペイン:**
                * 完了タスク一覧表示エリア (`#completedTaskList`)。各項目にアイコン形式の編集ボタンが付随。
* **モーダル1: 反省メモ入力モーダル**
    * **役割:** タスク完了時に表示され、予実を確認し反省を記録する。
    * **主要要素:**
        * 完了したタスク名表示
        * 予定時間表示 (HH:MM:SS)
        * 実績時間表示 (HH:MM:SS)
        * 反省メモ入力欄 (`textarea`)
        * 保存して完了ボタン
        * 閉じるボタン
